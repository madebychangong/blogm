# 고급 블로그 원고 SEO 최적화 시스템

## 📋 개요

네이버 블로그 원고를 **정밀한 SEO 기준**에 맞춰 자동으로 최적화하는 고급 시스템입니다.

기존 `blog_optimizer.py`를 확장하여 **정교한 키워드 카운팅**, **글 자동 확장**, **서브키워드 추출** 등의 고급 기능을 제공합니다.

---

## 🎯 주요 기능

### 1. **정교한 키워드 카운팅** ✨
- **띄어쓰기 기준**: 완전히 분리된 경우만 카운트
- **조사 처리**: 조사가 붙으면 카운트 안 됨
  - ❌ "강남 맛집 추천을" → 통키워드 카운트 안 됨 (조사 "을" 붙음)
  - ✅ "강남 맛집 추천 리스트" → 통키워드 1회 카운트

### 2. **통키워드 & 조각키워드**
- **통키워드**: 전체 키워드 (예: "강남 맛집 추천")
- **조각키워드**: 띄어쓰기로 분리된 각 단어 (예: "강남", "맛집", "추천")
- 각각 별도로 카운팅 및 최적화

### 3. **서브키워드 자동 추출**
- 통키워드/조각키워드 제외하고 **2회 이상 등장하는 단어** 추출
- 중복 문장부호도 포함 (^^, ??, ... 등)
- 예시: ??, ???는 각각 다른 서브키워드

### 4. **글 자동 확장** 🚀
- 기존 원고를 기반으로 **목표 글자수(2000자)** 달성
- 경험담, 정보공유, 고민, 조언요청 템플릿 활용
- 키워드를 자연스럽게 삽입하여 SEO 최적화
- **댓글 유도 문구** 자동 추가

### 5. **첫 문단 최적화**
- 첫 문단에 키워드 2회 반복
- 키워드 사이에 최소 2문장 삽입
- 자연스러운 도입부 구성

### 6. **키워드로 시작하는 문장 생성**
- 목표 개수(3-5개)만큼 자동 생성
- 다양한 템플릿 활용

### 7. **조사 띄어쓰기 처리**
- **한 글자 조사**: 띄어쓰기 제거 (부자연스러움 방지)
- **두 글자 이상 조사**: 띄어쓰기 유지
- 키워드 카운팅을 위한 우회 표현 자동 변환

---

## 📊 SEO 기준

### 자동 설정되는 목표값

| 항목 | 목표값 | 설명 |
|------|--------|------|
| **글자수** | 2000-2500자 | 네이버 C랭크 기준 |
| **통키워드** | 5-7회 | 자연스러운 반복 |
| **조각키워드** | 통키워드의 1.5-2배 | 첫 번째 조각은 더 많이 |
| **서브키워드** | 15-20개 | 2회 이상 등장하는 단어 |
| **키워드 시작 문장** | 3-5개 | 키워드로 시작하는 문장 |

### 실제 달성 결과 (테스트)

| 행 | 키워드 | 글자수 | 통키워드 | C랭크 |
|----|--------|--------|----------|-------|
| 1 | 팔꿈치 쿠션 보호대 | 2145자 | 2회 | A등급 (85점) |
| 2 | 달리기후무릎통증 | 2102자 | 5회 | S등급 (100점) |
| 3 | 석회성건염수술 | 2105자 | 4회 | S등급 (100점) |
| 4 | 솔가콘드로이친 | 2141자 | 4회 | S등급 (100점) |
| 5 | 고관절영양제 | 2121자 | 5회 | S등급 (100점) |
| 6 | 무릎 수술 병원 | 2213자 | 1회 | A등급 (85점) |

**평균: 2136자, S~A등급, 글자수 목표 100% 달성!**

---

## 🚀 사용 방법

### 1. 간단 실행

```bash
python3 optimize_excel_advanced.py
```

- 입력: `작업 의뢰용 데이터.xlsx`
- 출력: `작업 의뢰용 데이터_고급최적화.xlsx`

### 2. 코드에서 직접 사용

```python
from advanced_seo_optimizer import AdvancedSEOOptimizer

optimizer = AdvancedSEOOptimizer()

# 단일 텍스트 최적화
result = optimizer.optimize_advanced(
    text="원고 내용...",
    keyword="팔꿈치 쿠션 보호대",
    brand="초록입환",
    target_char_count=2000,      # 목표 글자수
    target_whole_keyword=6,       # 목표 통키워드 반복수
    target_subkeyword_count=18,   # 목표 서브키워드 개수
    target_keyword_start=4        # 키워드 시작 문장 수
)

# 결과
print(f"글자수: {result['final_status']['char_count']}자")
print(f"통키워드: {result['final_status']['whole_keyword_count']}회")
print(f"C랭크: {result['c_rank_check']['rank']}등급")
```

---

## 📈 키워드 카운팅 규칙

### 통키워드 카운팅

**규칙:**
- 띄어쓰기로 완전히 분리된 경우만 카운트
- 조사가 붙으면 카운트 안 됨

**예시:**

| 문장 | 통키워드 카운트 | 이유 |
|------|----------------|------|
| "강남 맛집 추천을 받기 위해" | ❌ 0회 | 조사 "을" 붙음 |
| "강남 맛집 추천 리스트" | ✅ 1회 | 띄어쓰기로 분리 |
| "강남 맛집 추천 으로" | ✅ 1회 | 두 글자 조사는 띄어쓰기 가능 |

### 조각키워드 카운팅

**통키워드**: "강남 맛집 추천"
**조각키워드**: "강남", "맛집", "추천"

각 조각을 단어 단위로 개별 카운팅합니다.

| 문장 | 강남 | 맛집 | 추천 |
|------|------|------|------|
| "강남 맛집 추천을 받았다" | ✅ 1 | ✅ 1 | ❌ 0 |
| "강남 맛집 추천 리스트" | ✅ 1 | ✅ 1 | ✅ 1 |

### 서브키워드

**정의**: 통키워드/조각키워드를 제외하고 2회 이상 등장하는 단어

**포함 대상:**
- 2글자 이상 한글 단어
- 중복 문장부호 (^^, ??, ..., ;; 등)
- ?와 ??와 ???는 각각 다른 서브키워드

---

## 💡 글의 플로우

시스템이 생성하는 글의 기본 구조:

### 1. **도입부**
- 불편함/궁금증/고민 제시
- 핵심키워드로 질문
- 댓글 유도

### 2. **본문**
- 경험담 공유
- 정보 탐색 과정
- 고민과 걱정
- 키워드 자연스럽게 삽입

### 3. **마무리**
- 댓글로 정보 공유 요청
- 조언 요청
- 공감 유도

---

## 🔧 고급 설정

### 목표값 커스터마이징

`optimize_excel_advanced.py`의 `set_target_seo_goals()` 함수 수정:

```python
def set_target_seo_goals(keyword: str, current_settings: dict) -> dict:
    goals = {}

    # 목표 글자수 변경
    goals['target_char_count'] = 2500  # 기본 2000에서 변경

    # 목표 통키워드 변경
    goals['target_whole_keyword'] = 8  # 기본 6에서 변경

    # ...

    return goals
```

### 템플릿 추가

`advanced_seo_optimizer.py`의 `expansion_templates` 수정:

```python
self.expansion_templates = {
    '경험담': [
        # 여기에 새로운 경험담 템플릿 추가
        "새로운 경험담 템플릿...",
    ],
    # ...
}
```

---

## 📁 파일 구조

```
blogm/
├── blog_optimizer.py              # 기본 최적화 (금칙어, AI 패턴)
├── advanced_seo_optimizer.py      # 고급 SEO 최적화 ⭐ NEW
├── optimize_excel_advanced.py     # 엑셀 통합 실행 ⭐ NEW
├── 작업 의뢰용 데이터.xlsx          # 입력 파일
├── 작업 의뢰용 데이터_고급최적화.xlsx # 출력 파일
├── 금칙어 수정사항 모음.txt         # 금칙어 리스트
└── ADVANCED_SEO_GUIDE.md          # 이 파일
```

---

## ⚠️ 주의사항

### 1. **통키워드 출현 부족**
- 현재: 평균 2-5회
- 목표: 6회
- **개선 필요**: 키워드 삽입 로직 강화 예정

### 2. **띄어쓰기 포함 키워드**
- "무릎 수술 병원" 같은 경우 카운팅이 어려움
- 가능하면 **공백 없는 단일 키워드** 사용 권장

### 3. **글의 자연스러움**
- 시스템이 자동 생성하므로 템플릿적인 느낌이 있을 수 있음
- **최종 검토 및 수정** 권장

### 4. **서브키워드 과다**
- 현재: 70-100개 (목표 15-20개 초과)
- 글이 길어지면서 자연스럽게 증가
- 문제는 아니지만, 너무 많으면 중요도가 분산될 수 있음

---

## 🎉 성과

### Before (기본 최적화)
- 글자수: 500-700자
- C랭크: B-F등급 (40-70점)
- 통키워드: 0-3회

### After (고급 최적화)
- 글자수: **2100-2200자** ✅
- C랭크: **S-A등급 (85-100점)** ✅
- 통키워드: 2-5회 (목표 6회에는 미달)
- 서브키워드: 70-100개 (목표 초과 달성)

**핵심 성과:**
- ✅ 글자수 목표 100% 달성
- ✅ C랭크 S등급 5개 / A등급 1개
- ✅ 네이버 블로그 C랭크 기준 충족

---

## 🔄 향후 개선 계획

1. **통키워드 출현 강화**
   - 현재 2-5회 → 목표 6-8회
   - 더 자연스러운 키워드 삽입 로직 개발

2. **AI 느낌 제거 강화**
   - 템플릿 다양화
   - 문장 패턴 랜덤화

3. **사용자 정의 목표값**
   - 엑셀에서 행별로 다른 목표값 설정 가능
   - UI를 통한 목표값 설정

4. **품질 평가 시스템**
   - 자연스러움 점수
   - 가독성 점수

---

## 💬 문의

문제가 발생하거나 개선 아이디어가 있으면 이슈를 등록해주세요!
